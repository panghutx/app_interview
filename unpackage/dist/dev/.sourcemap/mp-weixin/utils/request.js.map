{"version":3,"file":"request.js","sources":["utils/request.js"],"sourcesContent":["let requestCount = 0\n\nconst request = (options) => {\n  requestCount++\n  uni.showLoading({ title: '加载中', mask: true })\n  \n  return new Promise((resolve, reject) => {\r\n\t  console.log(\"底层request\",options)\n    uni.request({\n      url: 'http://127.0.0.1:8000' + options.url,\n      method: 'GET',\n      data: options.data || {},\n      header: {\r\n\t\t// 'Origin': 'http://localhost:8080',  // 显式声明\r\n\t\t'X-Requested-With': 'XMLHttpRequest',\n        'Content-Type': 'application/json',\n        'X-Token': uni.getStorageSync('token') || '',\n        ...options.header\n      },\n      success: (res) => {\r\n\t\t  console.log(res)\n        if (res.statusCode === 200) {\n          resolve(res.data)\n        } else {\n          uni.showToast({ title: res.data.msg || '请求异常', icon: 'none' })\n          reject(res)\n        }\n      },\n      fail: (err) => {\r\n\t\t  console.log(err)\n        uni.showToast({ title: '网络连接失败', icon: 'none' })\n        reject(err)\n      },\n      complete: () => {\n        if (--requestCount <= 0) {\n          uni.hideLoading()\n        }\n      }\n    })\n  })\n}\n\nexport default request"],"names":["uni"],"mappings":";;AAAA,IAAI,eAAe;AAEd,MAAC,UAAU,CAAC,YAAY;AAC3B;AACAA,gBAAG,MAAC,YAAY,EAAE,OAAO,OAAO,MAAM,MAAM;AAE5C,SAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AACvCA,kBAAAA,MAAY,MAAA,OAAA,yBAAA,aAAY,OAAO;AAC9BA,kBAAAA,MAAI,QAAQ;AAAA,MACV,KAAK,0BAA0B,QAAQ;AAAA,MACvC,QAAQ;AAAA,MACR,MAAM,QAAQ,QAAQ,CAAE;AAAA,MACxB,QAAQ;AAAA;AAAA,QAEZ,oBAAoB;AAAA,QACd,gBAAgB;AAAA,QAChB,WAAWA,cAAG,MAAC,eAAe,OAAO,KAAK;AAAA,QAC1C,GAAG,QAAQ;AAAA,MACZ;AAAA,MACD,SAAS,CAAC,QAAQ;AACpBA,sBAAAA,6CAAY,GAAG;AACX,YAAI,IAAI,eAAe,KAAK;AAC1B,kBAAQ,IAAI,IAAI;AAAA,QAC1B,OAAe;AACLA,8BAAI,UAAU,EAAE,OAAO,IAAI,KAAK,OAAO,QAAQ,MAAM,QAAQ;AAC7D,iBAAO,GAAG;AAAA,QACX;AAAA,MACF;AAAA,MACD,MAAM,CAAC,QAAQ;AACjBA,sBAAAA,6CAAY,GAAG;AACXA,sBAAG,MAAC,UAAU,EAAE,OAAO,UAAU,MAAM,QAAQ;AAC/C,eAAO,GAAG;AAAA,MACX;AAAA,MACD,UAAU,MAAM;AACd,YAAI,EAAE,gBAAgB,GAAG;AACvBA,wBAAAA,MAAI,YAAa;AAAA,QAClB;AAAA,MACF;AAAA,IACP,CAAK;AAAA,EACL,CAAG;AACH;;"}